<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Extraction | EDS Vignettes</title>
  <meta name="description" content="Data science resources for FES Students" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Extraction | EDS Vignettes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Data science resources for FES Students" />
  <meta name="github-repo" content="rajaoberison/edsy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Extraction | EDS Vignettes" />
  
  <meta name="twitter:description" content="Data science resources for FES Students" />
  

<meta name="author" content="Andry Rajaoberison" />


<meta name="date" content="2020-04-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reading.html"/>
<link rel="next" href="structuring.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">FES EDS Tutorials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>1</b> Reading</a>
<ul>
<li class="chapter" data-level="1.1" data-path="reading.html"><a href="reading.html#csv"><i class="fa fa-check"></i><b>1.1</b> CSV</a></li>
<li class="chapter" data-level="1.2" data-path="reading.html"><a href="reading.html#excel"><i class="fa fa-check"></i><b>1.2</b> Excel</a></li>
<li class="chapter" data-level="1.3" data-path="reading.html"><a href="reading.html#google-spreadsheets"><i class="fa fa-check"></i><b>1.3</b> Google Spreadsheets</a></li>
<li class="chapter" data-level="1.4" data-path="reading.html"><a href="reading.html#spss"><i class="fa fa-check"></i><b>1.4</b> SPSS</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="extraction.html"><a href="extraction.html"><i class="fa fa-check"></i><b>2</b> Extraction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="extraction.html"><a href="extraction.html#web-scraping"><i class="fa fa-check"></i><b>2.1</b> Web Scraping</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structuring.html"><a href="structuring.html"><i class="fa fa-check"></i><b>3</b> Structuring</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structuring.html"><a href="structuring.html#inspecting-the-data"><i class="fa fa-check"></i><b>3.1</b> Inspecting the data</a></li>
<li class="chapter" data-level="3.2" data-path="structuring.html"><a href="structuring.html#data-types"><i class="fa fa-check"></i><b>3.2</b> Data types</a></li>
<li class="chapter" data-level="3.3" data-path="structuring.html"><a href="structuring.html#subsetting-and-filtering"><i class="fa fa-check"></i><b>3.3</b> Subsetting and Filtering</a></li>
<li class="chapter" data-level="3.4" data-path="structuring.html"><a href="structuring.html#changing-cell-values"><i class="fa fa-check"></i><b>3.4</b> Changing cell values</a></li>
<li class="chapter" data-level="3.5" data-path="structuring.html"><a href="structuring.html#pivoting-the-dataset"><i class="fa fa-check"></i><b>3.5</b> Pivoting the dataset</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>4</b> Cleaning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cleaning.html"><a href="cleaning.html#fixing-skewed-distribution"><i class="fa fa-check"></i><b>4.1</b> Fixing skewed distribution</a></li>
<li class="chapter" data-level="4.2" data-path="cleaning.html"><a href="cleaning.html#fixing-outliers"><i class="fa fa-check"></i><b>4.2</b> Fixing outliers</a></li>
<li class="chapter" data-level="4.3" data-path="cleaning.html"><a href="cleaning.html#fixing-missing-values"><i class="fa fa-check"></i><b>4.3</b> Fixing missing values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5</b> Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="visualization.html"><a href="visualization.html#simple-graph-with-ggplot2"><i class="fa fa-check"></i><b>5.1</b> Simple graph with <code>ggplot2</code></a></li>
<li class="chapter" data-level="5.2" data-path="visualization.html"><a href="visualization.html#interactive-graph-with-plotly-and-gganimate"><i class="fa fa-check"></i><b>5.2</b> Interactive graph with <code>plotly</code> and <code>gganimate</code></a></li>
<li class="chapter" data-level="5.3" data-path="visualization.html"><a href="visualization.html#web-app-with-rshiny"><i class="fa fa-check"></i><b>5.3</b> Web app with RShiny</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="visualization.html"><a href="visualization.html#input-functions"><i class="fa fa-check"></i><b>5.3.1</b> Input functions</a></li>
<li class="chapter" data-level="5.3.2" data-path="visualization.html"><a href="visualization.html#output-functions"><i class="fa fa-check"></i><b>5.3.2</b> Output functions</a></li>
<li class="chapter" data-level="5.3.3" data-path="visualization.html"><a href="visualization.html#server-function"><i class="fa fa-check"></i><b>5.3.3</b> Server function</a></li>
<li class="chapter" data-level="5.3.4" data-path="visualization.html"><a href="visualization.html#sharing-your-app"><i class="fa fa-check"></i><b>5.3.4</b> Sharing your app</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>6</b> Analysis</a></li>
<li class="chapter" data-level="7" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>7</b> Resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EDS Vignettes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extraction" class="section level1" number="2">
<h1><span class="header-section-number">Section 2</span> Extraction</h1>
<div id="web-scraping" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Web Scraping</h2>
<p>Web scraping is the process of fetching and extracting information / data from a webpage. It is very useful if you want to create a dynamic database that updates based on the content of a specific website.</p>
<p>To scrap a webpage, we first need to know how to get to the webpage, a url that you can use to directly access the content. For example, to obtain the Google search results for “data science”, you can simply copy and paste this url to your browser: <a href="https://www.google.com/search?q=data+science" class="uri">https://www.google.com/search?q=data+science</a>, without having to type “data science” on a Google search web page. Some websites like Twitter or Facebook will require to you to use an API and authenticate in order to access some of their data.</p>
<p>For this example, we’re going to use The Weather Channel website which do not require autentification. We’ll to extract the 10-day forecast for a specific location and store the data in a dataframe.</p>
<p>After inspecting the website and it’s url, I have noticed that you can view the weather data by zip code using this url pattern:</p>
<p><code>https://weather.com/weather/</code> + <code>forecast type</code> + <code>/l/</code> + <code>zip_code</code> + <code>:4:US</code></p>
<p>For example, if we want to view the 10-day forecast for New Haven, we can go to: <a href="https://weather.com/weather/tenday/l/06511:4:US" class="uri">https://weather.com/weather/tenday/l/06511:4:US</a>. And for today’s forecast: <a href="https://weather.com/weather/today/l/06511:4:US" class="uri">https://weather.com/weather/today/l/06511:4:US</a></p>
<p>Once we have the webpage url, we can read it into R and extract the data using <code>rvest</code> from the <code>tidyverse</code> collection.</p>
<p>The New Haven 10-day forecast webpage looks like this:</p>
<div class="figure">
<img src="images/weatherpage.png" alt="" />
<p class="caption">weatherpage</p>
</div>
<p>Basically, what we want is the table that has the weather information. In order to extract the values that we want, we have to know where in the source code they are located. For example, in the “DAY” column, we want to extract the <code>exact date</code> instead of the <code>days of the week</code>. And we can do that by:</p>
<ul>
<li>inspecting the tag or class of exact date from the website. Move the cursor to the exact date, right-click, then choose <code>Inspect</code></li>
<li>then, a window will open, which will point directly to the location of the <code>exact date</code> in the source code. Take notes of the css (tag or class name), and use it to get the <code>exact date</code> value using the <code>html_nodes()</code> function.</li>
</ul>
<div class="figure">
<img src="images/webcss.png" alt="" />
<p class="caption">weatherpage</p>
</div>
<p>Here is how we extract the dates:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="extraction.html#cb17-1"></a><span class="kw">library</span>(rvest)</span></code></pre></div>
<pre><code>## Loading required package: xml2</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="extraction.html#cb19-1"></a><span class="co"># Get the webpage url</span></span>
<span id="cb19-2"><a href="extraction.html#cb19-2"></a>url =<span class="st"> &#39;https://weather.com/weather/tenday/l/06511:4:US&#39;</span></span>
<span id="cb19-3"><a href="extraction.html#cb19-3"></a><span class="co"># Load the webpage using the url</span></span>
<span id="cb19-4"><a href="extraction.html#cb19-4"></a>webpage &lt;-<span class="st"> </span><span class="kw">read_html</span>(url)</span>
<span id="cb19-5"><a href="extraction.html#cb19-5"></a></span>
<span id="cb19-6"><a href="extraction.html#cb19-6"></a><span class="co"># Getting the exact date</span></span>
<span id="cb19-7"><a href="extraction.html#cb19-7"></a><span class="co"># Filtering the relevant css / location</span></span>
<span id="cb19-8"><a href="extraction.html#cb19-8"></a>date_locations &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage, <span class="st">&quot;span.day-detail.clearfix&quot;</span>)</span>
<span id="cb19-9"><a href="extraction.html#cb19-9"></a><span class="co"># Extracting the exact value</span></span>
<span id="cb19-10"><a href="extraction.html#cb19-10"></a>raw_date &lt;-<span class="st"> </span><span class="kw">html_text</span>(date_locations)</span>
<span id="cb19-11"><a href="extraction.html#cb19-11"></a>raw_date</span></code></pre></div>
<pre><code>##  [1] &quot;APR 8&quot;  &quot;APR 9&quot;  &quot;APR 10&quot; &quot;APR 11&quot; &quot;APR 12&quot; &quot;APR 13&quot; &quot;APR 14&quot; &quot;APR 15&quot;
##  [9] &quot;APR 16&quot; &quot;APR 17&quot; &quot;APR 18&quot; &quot;APR 19&quot; &quot;APR 20&quot; &quot;APR 21&quot; &quot;APR 22&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="extraction.html#cb21-1"></a><span class="co"># Because the value are formatted like &quot;NOV 21&quot; we have to convert to a date format</span></span>
<span id="cb21-2"><a href="extraction.html#cb21-2"></a>exact_date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(raw_date, <span class="dt">format=</span><span class="st">&quot;%b %d&quot;</span>) <span class="co"># b = month, d = day</span></span>
<span id="cb21-3"><a href="extraction.html#cb21-3"></a>exact_date</span></code></pre></div>
<pre><code>##  [1] &quot;2020-04-08&quot; &quot;2020-04-09&quot; &quot;2020-04-10&quot; &quot;2020-04-11&quot; &quot;2020-04-12&quot;
##  [6] &quot;2020-04-13&quot; &quot;2020-04-14&quot; &quot;2020-04-15&quot; &quot;2020-04-16&quot; &quot;2020-04-17&quot;
## [11] &quot;2020-04-18&quot; &quot;2020-04-19&quot; &quot;2020-04-20&quot; &quot;2020-04-21&quot; &quot;2020-04-22&quot;</code></pre>
<p>And here is the full code that extract the complete table:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="extraction.html#cb23-1"></a><span class="kw">library</span>(rvest)</span>
<span id="cb23-2"><a href="extraction.html#cb23-2"></a><span class="co"># Get the webpage url</span></span>
<span id="cb23-3"><a href="extraction.html#cb23-3"></a>url =<span class="st"> &#39;https://weather.com/weather/tenday/l/06511:4:US&#39;</span></span>
<span id="cb23-4"><a href="extraction.html#cb23-4"></a><span class="co"># Load the webpage using the url</span></span>
<span id="cb23-5"><a href="extraction.html#cb23-5"></a>webpage &lt;-<span class="st"> </span><span class="kw">read_html</span>(url)</span>
<span id="cb23-6"><a href="extraction.html#cb23-6"></a></span>
<span id="cb23-7"><a href="extraction.html#cb23-7"></a><span class="co"># Getting the exact date</span></span>
<span id="cb23-8"><a href="extraction.html#cb23-8"></a><span class="co"># Filtering the relevant css / location</span></span>
<span id="cb23-9"><a href="extraction.html#cb23-9"></a>date_locations &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage, <span class="st">&quot;span.day-detail.clearfix&quot;</span>)</span>
<span id="cb23-10"><a href="extraction.html#cb23-10"></a><span class="co"># Extracting the exact value</span></span>
<span id="cb23-11"><a href="extraction.html#cb23-11"></a>raw_date &lt;-<span class="st"> </span><span class="kw">html_text</span>(date_locations)</span>
<span id="cb23-12"><a href="extraction.html#cb23-12"></a><span class="co"># Because the value are formatted like &quot;Nov 21&quot; we have to convert to a date format</span></span>
<span id="cb23-13"><a href="extraction.html#cb23-13"></a>exact_date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(raw_date, <span class="dt">format=</span><span class="st">&quot;%b %d&quot;</span>) <span class="co"># b = month, d = day</span></span>
<span id="cb23-14"><a href="extraction.html#cb23-14"></a></span>
<span id="cb23-15"><a href="extraction.html#cb23-15"></a><span class="co"># Getting the weather description</span></span>
<span id="cb23-16"><a href="extraction.html#cb23-16"></a>desc_loc &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage, <span class="st">&quot;td.description&quot;</span>)</span>
<span id="cb23-17"><a href="extraction.html#cb23-17"></a>desc &lt;-<span class="st"> </span><span class="kw">html_text</span>(desc_loc)</span>
<span id="cb23-18"><a href="extraction.html#cb23-18"></a></span>
<span id="cb23-19"><a href="extraction.html#cb23-19"></a><span class="co"># Getting the temperature</span></span>
<span id="cb23-20"><a href="extraction.html#cb23-20"></a>temp_loc &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage, <span class="st">&quot;td.temp&quot;</span>)</span>
<span id="cb23-21"><a href="extraction.html#cb23-21"></a>temp &lt;-<span class="st"> </span><span class="kw">html_text</span>(temp_loc)</span>
<span id="cb23-22"><a href="extraction.html#cb23-22"></a><span class="co"># High and Low temperature values</span></span>
<span id="cb23-23"><a href="extraction.html#cb23-23"></a>high_temp &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(temp))</span>
<span id="cb23-24"><a href="extraction.html#cb23-24"></a>low_temp &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(temp))</span>
<span id="cb23-25"><a href="extraction.html#cb23-25"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(temp)){</span>
<span id="cb23-26"><a href="extraction.html#cb23-26"></a>all &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>(temp[i], <span class="st">&quot;°&quot;</span>))</span>
<span id="cb23-27"><a href="extraction.html#cb23-27"></a><span class="cf">if</span> (<span class="kw">length</span>(all) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>){</span>
<span id="cb23-28"><a href="extraction.html#cb23-28"></a>high_temp[i] &lt;-<span class="st"> </span>all[<span class="dv">1</span>]</span>
<span id="cb23-29"><a href="extraction.html#cb23-29"></a>low_temp[i] &lt;-<span class="st"> </span>all[<span class="dv">2</span>]</span>
<span id="cb23-30"><a href="extraction.html#cb23-30"></a>} <span class="cf">else</span> {</span>
<span id="cb23-31"><a href="extraction.html#cb23-31"></a>low_temp[i] &lt;-<span class="st"> </span><span class="dv">38</span></span>
<span id="cb23-32"><a href="extraction.html#cb23-32"></a>}</span>
<span id="cb23-33"><a href="extraction.html#cb23-33"></a>}</span>
<span id="cb23-34"><a href="extraction.html#cb23-34"></a></span>
<span id="cb23-35"><a href="extraction.html#cb23-35"></a><span class="co"># Getting the precipitation</span></span>
<span id="cb23-36"><a href="extraction.html#cb23-36"></a>precip_loc &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage, <span class="st">&quot;td.precip&quot;</span>)</span>
<span id="cb23-37"><a href="extraction.html#cb23-37"></a>precip &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">sub</span>(<span class="st">&quot;%&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">html_text</span>(precip_loc))) <span class="op">/</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb23-38"><a href="extraction.html#cb23-38"></a></span>
<span id="cb23-39"><a href="extraction.html#cb23-39"></a><span class="co"># Getting the wind</span></span>
<span id="cb23-40"><a href="extraction.html#cb23-40"></a>wind_loc &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage, <span class="st">&quot;td.wind&quot;</span>)</span>
<span id="cb23-41"><a href="extraction.html#cb23-41"></a>wind &lt;-<span class="st"> </span><span class="kw">html_text</span>(wind_loc)</span>
<span id="cb23-42"><a href="extraction.html#cb23-42"></a><span class="co"># Wind direction and speed</span></span>
<span id="cb23-43"><a href="extraction.html#cb23-43"></a>wind_dir &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(wind))</span>
<span id="cb23-44"><a href="extraction.html#cb23-44"></a>wind_speed &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(wind))</span>
<span id="cb23-45"><a href="extraction.html#cb23-45"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(wind)){</span>
<span id="cb23-46"><a href="extraction.html#cb23-46"></a>all &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>(wind[i], <span class="st">&quot; &quot;</span>))</span>
<span id="cb23-47"><a href="extraction.html#cb23-47"></a>wind_dir[i] &lt;-<span class="st"> </span>all[<span class="dv">1</span>]</span>
<span id="cb23-48"><a href="extraction.html#cb23-48"></a>wind_speed[i] &lt;-<span class="st"> </span>all[<span class="dv">2</span>]</span>
<span id="cb23-49"><a href="extraction.html#cb23-49"></a>}</span>
<span id="cb23-50"><a href="extraction.html#cb23-50"></a></span>
<span id="cb23-51"><a href="extraction.html#cb23-51"></a><span class="co"># Getting the humidity</span></span>
<span id="cb23-52"><a href="extraction.html#cb23-52"></a>humidity_loc &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage, <span class="st">&quot;td.humidity&quot;</span>)</span>
<span id="cb23-53"><a href="extraction.html#cb23-53"></a>humidity &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">sub</span>(<span class="st">&quot;%&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">html_text</span>(humidity_loc))) <span class="op">/</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb23-54"><a href="extraction.html#cb23-54"></a></span>
<span id="cb23-55"><a href="extraction.html#cb23-55"></a><span class="co"># Save the data in tibble</span></span>
<span id="cb23-56"><a href="extraction.html#cb23-56"></a><span class="kw">library</span>(tibble)</span>
<span id="cb23-57"><a href="extraction.html#cb23-57"></a>new_haven_forecast &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&#39;day&#39;</span> =<span class="st"> </span>exact_date, <span class="st">&#39;description&#39;</span> =<span class="st"> </span>desc,</span>
<span id="cb23-58"><a href="extraction.html#cb23-58"></a>                        <span class="st">&#39;high_temp&#39;</span> =<span class="st"> </span>high_temp, <span class="st">&#39;low_temp&#39;</span> =<span class="st"> </span>low_temp,</span>
<span id="cb23-59"><a href="extraction.html#cb23-59"></a>                        <span class="st">&#39;precip&#39;</span> =<span class="st"> </span>precip, <span class="st">&#39;wind_dir&#39;</span> =<span class="st"> </span>wind_dir,</span>
<span id="cb23-60"><a href="extraction.html#cb23-60"></a>                        <span class="st">&#39;wind_speed&#39;</span> =<span class="st"> </span>wind_speed, <span class="st">&#39;himidity&#39;</span> =<span class="st"> </span>humidity)</span>
<span id="cb23-61"><a href="extraction.html#cb23-61"></a>new_haven_forecast</span></code></pre></div>
<pre><code>## # A tibble: 15 x 8
##    day        description high_temp low_temp precip wind_dir wind_speed himidity
##    &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt;
##  1 2020-04-08 Mostly Cle… &lt;NA&gt;      38          0.1 S        4             0.88 
##  2 2020-04-09 Rain        58        39          1   S        19            0.82 
##  3 2020-04-10 Partly Clo… 51        37          0   WNW      21            0.47 
##  4 2020-04-11 Partly Clo… 52        37          0   WNW      15            0.41 
##  5 2020-04-12 Partly Clo… 57        50          0.1 SSE      13            0.54 
##  6 2020-04-13 Rain/Wind   64        48          0.9 S        22            0.82 
##  7 2020-04-14 Partly Clo… 58        41          0.2 WNW      10            0.55 
##  8 2020-04-15 Showers     52        38          0.4 NNW      9             0.53 
##  9 2020-04-16 Mostly Sun… 51        39          0.2 WNW      13            0.47 
## 10 2020-04-17 Partly Clo… 51        40          0.1 WNW      13            0.49 
## 11 2020-04-18 Showers     51        42          0.5 NE       11            0.59 
## 12 2020-04-19 Showers     56        43          0.4 WNW      12            0.59 
## 13 2020-04-20 Showers     56        43          0.4 WNW      13            0.580
## 14 2020-04-21 AM Showers  57        46          0.3 NW       11            0.56 
## 15 2020-04-22 Showers     60        49          0.5 SSW      11            0.61</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reading.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="structuring.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rajaoberison/edsy/edit/master/02-extraction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["edsy.pdf", "edsy.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
